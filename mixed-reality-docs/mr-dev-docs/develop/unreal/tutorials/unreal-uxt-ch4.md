---
title: 4. シーンを対話型にする
description: Unreal Engine 4 と Mixed Reality ツールキット UX ツール プラグインを使用してチェス アプリを構築するためのチュートリアル シリーズのパート 6 の 4
author: hferrone
ms.author: v-hferrone
ms.date: 11/18/2020
ms.topic: article
ms.localizationpriority: high
keywords: Unreal, Unreal Engine 4, UE4, HoloLens, HoloLens 2, Mixed Reality, チュートリアル, はじめに, mrtk, uxt, UX ツール, ドキュメント, Mixed Reality ヘッドセット, Windows Mixed Reality ヘッドセット, 仮想現実ヘッドセット
ms.openlocfilehash: c26f5579aad29624c9a8f374caa4799423d0637e
ms.sourcegitcommit: 04927427226928bd9178da0049d4cef626a6b0bf
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/21/2021
ms.locfileid: "98635442"
---
# <a name="4-making-your-scene-interactive"></a>4.シーンを対話型にする

前のチュートリアルでは、ARSession、ポーン、およびゲーム モードを追加して、チェス アプリの Mixed Reality セットアップを完了しました。 このセクションでは、オープン ソースの [Mixed Reality Toolkit UX Tools](https://github.com/microsoft/MixedReality-UXTools-Unreal) プラグインの使用方法について説明します。このプラグインには、シーンを対話型にするためのツールが用意されています。 このセクションを終えると、チェスの駒がユーザー入力によって動くようになります。

## <a name="objectives"></a>目標

* GitHub から Mixed Reality UX Tools プラグインをインストールする
* ハンド インタラクション アクターを指先に追加する
* シーン内のオブジェクトにマニピュレーターを作成して追加する
* 入力シミュレーションを使用してプロジェクトを検証する

## <a name="downloading-the-mixed-reality-ux-tools-plugin"></a>Mixed Reality UX Tools プラグインをダウンロードする
ユーザー入力の操作を開始する前に、プラグインをプロジェクトに追加する必要があります。

1. GitHub 上にある Mixed Reality UX Tools の [リリース ページ](https://github.com/microsoft/MixedReality-UXTools-Unreal/releases)で、UX Tools for Unreal v0.10.0 のリリースに移動し、**UXTools.0.10.0.zip** をダウンロードします。 ファイルを解凍します。

2.  プロジェクトのルート フォルダーに、**Plugins** という名前の新しいフォルダーを作成します。 解凍された UXTools プラグインをこのフォルダーにコピーし、Unreal エディターを再起動します。

![プロジェクト プラグイン フォルダーを作成する](images/unreal-uxt/4-plugins.PNG)

3.  UX Tools プラグインには、**ボタン**、**入力シミュレーション**、**ポインター** を含むコンポーネント用のサブフォルダーのある Content フォルダーと、その他のコード用の C++ Classes フォルダーがあります。  

> [!NOTE]
> **コンテンツ ブラウザー** に **[UXTools コンテンツ]** セクションが表示されない場合は、 **[表示オプション] > [プラグイン コンテンツを表示する]** をクリックします。

![プラグイン コンテンツを表示する](images/unreal-uxt/4-showplugincontent.PNG)

Mixed Reality UX Tools の GitHub [リポジトリ](https://aka.ms/uxt-unreal)には、プラグインに関するドキュメントが他にもあります。

プラグインがインストールされたら、プラグインから提供されるツールを使用する準備が整います。まずはハンド インタラクション アクターから使い始めます。

## <a name="spawning-hand-interaction-actors"></a>ハンド インタラクション アクターを生成する

UX 要素とのハンド インタラクションは、ハンド インタラクション アクターを使用して行われます。これにより、近接および遠隔のインタラクションのポインターとビジュアルが作成および起動されます。
- *近接インタラクション* - 人差し指と親指で要素をつまむか、指先でそれらをつつくこと。
- *遠隔インタラクション* - 仮想ハンドの光線を要素にあてて、人差し指と親指を一緒に押すこと。

この例では、**MRPawn** にハンド インタラクション アクターを追加すると、次の処理が行われます。
- ポーンの人差し指の先端にカーソルを追加します。
- ポーンを介して操作できる多関節ハンド入力イベントを提供します。
- 仮想ハンドの手のひらから伸びる手の光線を通して、遠くの相互作用入力イベントを許可します。

続ける前に、ハンド インタラクションに関する[ドキュメント](https://microsoft.github.io/MixedReality-UXTools-Unreal/Docs/HandInteraction.html)を参照することをお勧めします。

準備ができたら、**MRPawn** ブループリントを開き、 **[Event Graph]\(イベント グラフ\)** に移動します。

1. **Event BeginPlay** から実行ピンをドラッグ アンド リリースして、新しいノードを配置します。
    * **[Spawn Actor from Class]** を選択し、 **[クラス]** ピンの横にあるドロップダウンをクリックし、**Uxt ハンド インタラクション アクター** を検索します。  

2. 2 番目の **Uxt ハンド インタラクション アクター** を生成します。今回は、**手** を **右** に設定します。 イベントが開始されると、Uxt ハンド インタラクション アクターがそれぞれの手で生成されます。

**イベント グラフ** は、次のスクリーンショットと一致している必要があります。

![Uxt ハンド インタラクション アクターを生成する](images/unreal-uxt/4-spawnactor.PNG)

Uxt ハンド インタラクション アクターには、オーナーと最初の変換場所が必要です。 UX Tools はハンド インタラクション アクターが表示されるとすぐに仮想ハンドにジャンプするため、この場合は最初の変換は重要ではありません。 ただし、`SpawnActor` 機能では、コンパイラ エラーを回避するために変換入力が必要であるため、既定値を使用します。

1. **Spawn Transform** ピンの 1 つからピンをドラッグ アンド リリースして、新しいノードを配置します。
    * **Make Transform** ノードを検索し、**戻り値** をもう一方の **Spawn Transform** にドラッグして、両方の **SpawnActor** ノードが接続されるようにします。

2.  両方の **SpawnActor** ノードの下部にある **下矢印** を選択して、 **[Owner]\(所有者\)** ピンを表示します。    
    * **[所有者]** ピンの 1 つからピンをドラッグ アンド リリースして、新しいノードを配置します。
    * **self** を検索し、**Get a reference to self** 変数を選択します。
    * **Self** オブジェクト参照ノードともう一方のハンド インタラクション アクターの **[Owner]\(所有者\)** ピンの間にもリンクを作成します。
3. 最後に、両方のハンド インタラクション アクターの **[Show Near Cursor on Grab Targets]\(つかむ対象の近くにあるカーソルを表示する\)** チェック ボックスをオンにします。 人差し指が近づくとつかむ対象に重ねてカーソルが表示されるので、ターゲットに対する指の相対位置を確認しやすくなります。
    * **コンパイル** と **保存** を行って、メイン ウィンドウに戻ります。

接続が次のスクリーンショットと一致していることを確認しますが、ブループリントを読みやすくするためにノードをドラッグしてもかまいません。

![Uxt ハンド インタラクション アクターのセットアップを完了する](images/unreal-uxt/4-fingerptrs.PNG)

ハンド インタラクション アクターの詳細については、[UX Tools のドキュメント](https://microsoft.github.io/MixedReality-UXTools-Unreal/Docs/HandInteraction.html)にもあります。

これで、プロジェクトの仮想ハンドはオブジェクトを選択できるようになりましたが、オブジェクトを操作することはできません。 アプリをテストする前の最後のタスクは、シーン内のアクターにマニピュレーター コンポーネントを追加することです。

## <a name="attaching-manipulators"></a>マニピュレーターの添付

マニピュレーターは、多関節ハンドによる入力に応答するコンポーネントであり、つかんだり、回転させたり、および変換したりできます。 マニピュレーターの変換をアクターの変換に適用すると、アクターの直接操作が可能になります。

1. **[ボード]** ブループリントを開き、 **[コンポーネントの追加]** をクリックして、 **[コンポーネント]** パネルで **Uxt 汎用マニピュレーター** を検索します。

![汎用マニピュレーターを追加する](images/unreal-uxt/4-addmanip.PNG)

2. **[詳細]** パネルの **[汎用マニピュレーター]** セクションを展開します。 ここから片手または両手操作、回転モード、スムージングを設定できます。 好きなモードを自由に選択して、ボードを **コンパイル** し、**保存** します。

![モードを設定する](images/unreal-uxt/4-setrotmode.PNG)

3. **WhiteKing** アクターについて上記の手順を繰り返します。

Mixed Reality UX Tools プラグインに用意されているマニピュレーター コンポーネントの詳細については、[ドキュメント](https://microsoft.github.io/MixedReality-UXTools-Unreal/Docs/Manipulator.html)を参照してください。

## <a name="testing-the-scene"></a>シーンのテスト

良い知らせです。 これで、新しい仮想ハンドとユーザー入力でアプリをテストする準備が整いました。 メイン ウィンドウで **[Play]\(再生\)** を押すと、2 つのメッシュ ハンドが提供され、それぞれの手の平からレイが伸びているのを確認できます。 次のように、手とその相互作用を制御できます。
- **左 Alt** キーを押しながら **左手** を制御し、**左 Shift** キーを押して **右手** を制御します。
- マウスを動かして手を動かし、**マウス ホイール** を使用してスクロールして、手を **前方** または **後方** に移動します。
- 左マウス ボタンを使用して **ピンチ** を行い、マウスの中央ボタンを使用して **指さし** を行います。

> [!NOTE]
> PC に複数のヘッドセットが接続されている場合、入力シミュレーションが機能しない可能性があります。 問題が発生している場合は、他のヘッドセットを取り外してみてください。

![ビューポート内のシミュレートされた手](images/unreal-uxt/4-handsim.PNG)

シミュレートされた手を使用して、チェスの白キングを手に取り、移動して、置いて、ボードを操作してみましょう。 近接インタラクションと遠隔インタラクションの両方を試してみてください。手がボードとキングを直接つかめる位置まで近づくと、ハンド レイが人差し指の先が指カーソルに置き換わります。

MRTK UX Tools プラグインに用意されているシミュレートされた手の機能の詳細については、[ドキュメント](https://microsoft.github.io/MixedReality-UXTools-Unreal/Docs/InputSimulation.html)を参照してください。

これで、仮想ユーザーがオブジェクトと対話できるようになったので、次のチュートリアルに進み、ユーザー インターフェイスとイベントを追加する準備ができました。

[次のセクション: 5.ボタンの追加およびピースの位置のリセット](unreal-uxt-ch5.md)
